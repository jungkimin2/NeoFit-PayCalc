<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeoFit PayCalc - 네오핏 급여 계산기</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { 
            getAuth, 
            signInWithEmailAndPassword,
            onAuthStateChanged,
            signOut
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { 
            getFirestore,
            collection,
            doc,
            setDoc,
            getDoc,
            getDocs,
            query,
            where,
            orderBy,
            onSnapshot,
            deleteDoc,
            updateDoc,
            serverTimestamp,
            writeBatch
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase 설정
        const firebaseConfig = {
            apiKey: "AIzaSyC9Nqji4jQe8po0BFfMo8czGSkXLuI2H3U",
            authDomain: "neofit-paycalc.firebaseapp.com",
            projectId: "neofit-paycalc",
            storageBucket: "neofit-paycalc.firebasestorage.app",
            messagingSenderId: "1072136228278",
            appId: "1:1072136228278:web:5d3be856d357b273900517",
            measurementId: "G-YWWC4R2EP4"
        };

        // Firebase 초기화
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // 전역으로 사용할 수 있도록 window 객체에 할당
        window.firebase = {
            auth,
            db,
            // Auth 함수들
            signInWithEmailAndPassword,
            onAuthStateChanged,
            signOut,
            // Firestore 함수들
            collection,
            doc,
            setDoc,
            getDoc,
            getDocs,
            query,
            where,
            orderBy,
            onSnapshot,
            deleteDoc,
            updateDoc,
            serverTimestamp,
            writeBatch
        };
    </script>
    
    <style>
        * {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type=number] {
            -moz-appearance: textfield;
        }

        .glow-green {
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.4), 0 0 60px rgba(0, 255, 136, 0.2);
        }

        .hover-glow:hover {
            box-shadow: 0 0 25px rgba(0, 255, 136, 0.5);
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 1;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        .gradient-border {
            position: relative;
            background: transparent;
            border: 1px solid #00FF88;
            border-radius: 1.5rem;
        }

        .gradient-border > div {
            background: transparent;
            padding: 2rem;
        }

        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        /* 로그인 화면 스타일 */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 100%);
            padding: 1rem;
        }

        .login-box {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 1.5rem;
            padding: 3rem;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .login-title {
            font-size: 2.5rem;
            font-weight: bold;
            text-align: center;
            background: linear-gradient(135deg, #00FF88 0%, #00CC6A 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 2rem;
        }

        .login-input {
            width: 100%;
            padding: 1rem 1.5rem;
            margin-bottom: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .login-input:focus {
            outline: none;
            border-color: #00FF88;
            box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.1);
        }

        .login-button {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, #00FF88 0%, #00CC6A 100%);
            border: none;
            border-radius: 0.75rem;
            color: #0f0f0f;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 255, 136, 0.3);
        }

        .login-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            font-size: 0.875rem;
            text-align: center;
        }

        /* 로딩 스피너 */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #00FF88;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* 상단 바 스타일 */
        .top-bar {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.875rem;
        }

        .logout-button {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem;
            color: white;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .logout-button:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.3);
        }

        /* 동기화 상태 표시 */
        .sync-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 0.5rem;
            color: #00FF88;
            font-size: 0.875rem;
        }

        .sync-icon {
            width: 12px;
            height: 12px;
            background: #00FF88;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* 반응형 수정 */
        @media (max-width: 768px) {
            .login-box {
                padding: 2rem;
            }

            .login-title {
                font-size: 2rem;
            }

            .top-bar {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }

            .user-info {
                font-size: 0.75rem;
            }
        }

        /* 기존 스타일들 추가 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .slide-in {
            animation: slideIn 0.3s ease-out;
        }

        .bounce {
            animation: bounce 2s infinite;
        }

        /* 주요 UI 요소 스타일 */
        .main-container {
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 100%);
            min-height: 100vh;
            color: white;
        }

        .content-wrapper {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* 버튼 스타일 */
        .btn-primary {
            background: linear-gradient(135deg, #00FF88 0%, #00CC6A 100%);
            color: #0f0f0f;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 255, 136, 0.3);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 0.75rem 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.3);
        }

        /* 카드 스타일 */
        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
        }

        /* 모달 스타일 */
        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1.5rem;
            padding: 2rem;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        /* Tailwind-like utilities */
        .text-center { text-align: center; }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-3xl { font-size: 1.875rem; }
        .text-4xl { font-size: 2.25rem; }
        .text-5xl { font-size: 3rem; }
        .font-bold { font-weight: 700; }
        .font-semibold { font-weight: 600; }
        .font-black { font-weight: 900; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-6 { margin-top: 1.5rem; }
        .mt-8 { margin-top: 2rem; }
        .p-2 { padding: 0.5rem; }
        .p-4 { padding: 1rem; }
        .p-5 { padding: 1.25rem; }
        .p-6 { padding: 1.5rem; }
        .p-8 { padding: 2rem; }
        .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .gap-2 { gap: 0.5rem; }
        .gap-3 { gap: 0.75rem; }
        .gap-4 { gap: 1rem; }
        .gap-6 { gap: 1.5rem; }
        .space-y-2 > * + * { margin-top: 0.5rem; }
        .space-y-3 > * + * { margin-top: 0.75rem; }
        .space-y-4 > * + * { margin-top: 1rem; }
        .rounded { border-radius: 0.25rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .rounded-xl { border-radius: 0.75rem; }
        .rounded-2xl { border-radius: 1rem; }
        .rounded-full { border-radius: 9999px; }
        .w-full { width: 100%; }
        .flex { display: flex; }
        .grid { display: grid; }
        .hidden { display: none; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .flex-col { flex-direction: column; }
        .transition-all { transition-property: all; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 150ms; }
        .scale-105 { transform: scale(1.05); }
        .hover\:scale-105:hover { transform: scale(1.05); }
        .cursor-pointer { cursor: pointer; }
        .opacity-70 { opacity: 0.7; }
        .opacity-80 { opacity: 0.8; }
        .text-white { color: white; }
        .text-gray-300 { color: rgb(209 213 219); }
        .text-gray-400 { color: rgb(156 163 175); }
        .text-gray-500 { color: rgb(107 114 128); }
        .text-green-400 { color: rgb(74 222 128); }
        .text-blue-400 { color: rgb(96 165 250); }
        .text-orange-400 { color: rgb(251 146 60); }
        .bg-gray-800\/50 { background-color: rgb(31 41 55 / 0.5); }
        .border { border-width: 1px; }
        .border-b { border-bottom-width: 1px; }
        .border-gray-400 { border-color: rgb(156 163 175); }
        .border-gray-600 { border-color: rgb(75 85 99); }
        .border-gray-700 { border-color: rgb(55 65 81); }
        .border-green-400 { border-color: rgb(74 222 128); }
        .border-green-500 { border-color: rgb(34 197 94); }
        .border-blue-500 { border-color: rgb(59 130 246); }
        .border-orange-500 { border-color: rgb(249 115 22); }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1); }

        /* Grid layouts */
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }

        @media (min-width: 640px) {
            .sm\:px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
            .sm\:px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
            .sm\:w-32 { width: 8rem; }
            .sm\:w-36 { width: 9rem; }
            .sm\:text-base { font-size: 1rem; }
            .sm\:text-sm { font-size: 0.875rem; }
            .sm\:text-lg { font-size: 1.125rem; }
            .sm\:text-3xl { font-size: 1.875rem; }
            .sm\:p-3 { padding: 0.75rem; }
            .sm\:p-6 { padding: 1.5rem; }
            .sm\:gap-3 { gap: 0.75rem; }
            .sm\:gap-6 { gap: 1.5rem; }
            .sm\:mb-3 { margin-bottom: 0.75rem; }
            .sm\:mb-8 { margin-bottom: 2rem; }
            .sm\:inline { display: inline; }
        }

        @media (min-width: 768px) {
            .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
            .md\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
            .md\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        }

        @media (min-width: 1024px) {
            .lg\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
        }

        /* Custom scrollbar */
        .overflow-y-auto {
            overflow-y: auto;
        }

        .whitespace-nowrap {
            white-space: nowrap;
        }

        /* Focus states */
        .focus\:border-green-400:focus {
            border-color: rgb(74 222 128);
        }

        .focus\:border-blue-500:focus {
            border-color: rgb(59 130 246);
        }

        .focus\:border-orange-400:focus {
            border-color: rgb(251 146 60);
        }

        .focus\:outline-none:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
        }

        /* Hover states */
        .hover\:border-gray-400:hover {
            border-color: rgb(156 163 175);
        }

        .hover\:border-green-400:hover {
            border-color: rgb(74 222 128);
        }

        .hover\:border-blue-400:hover {
            border-color: rgb(59 130 246);
        }

        .hover\:border-orange-400:hover {
            border-color: rgb(251 146 60);
        }

        .hover\:shadow-lg:hover {
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        .hover\:text-white:hover {
            color: white;
        }

        .hover\:scale-\[1\.02\]:hover {
            transform: scale(1.02);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // 로그인 컴포넌트
        const LoginComponent = ({ onLogin }) => {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const [loading, setLoading] = useState(false);

            const handleLogin = async (e) => {
                e.preventDefault();
                setError('');
                setLoading(true);

                try {
                    const userCredential = await window.firebase.signInWithEmailAndPassword(
                        window.firebase.auth, 
                        email, 
                        password
                    );
                    onLogin(userCredential.user);
                } catch (err) {
                    console.error('Login error:', err);
                    let errorMessage = '로그인에 실패했습니다.';
                    
                    if (err.code === 'auth/user-not-found') {
                        errorMessage = '등록되지 않은 이메일입니다.';
                    } else if (err.code === 'auth/wrong-password') {
                        errorMessage = '비밀번호가 올바르지 않습니다.';
                    } else if (err.code === 'auth/invalid-email') {
                        errorMessage = '올바른 이메일 형식이 아닙니다.';
                    }
                    
                    setError(errorMessage);
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="login-container">
                    <div className="login-box">
                        <h1 className="login-title">NeoFit PayCalc</h1>
                        <p style={{textAlign: 'center', color: 'rgba(255, 255, 255, 0.6)', marginBottom: '2rem'}}>
                            네오핏 급여 계산기
                        </p>
                        
                        {error && <div className="login-error">{error}</div>}
                        
                        <form onSubmit={handleLogin}>
                            <input
                                type="email"
                                className="login-input"
                                value={email}
                                onChange={(e) => setEmail(e.target.value)}
                                placeholder="이메일"
                                required
                                autoComplete="email"
                            />
                            <input
                                type="password"
                                className="login-input"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                placeholder="비밀번호"
                                required
                                autoComplete="current-password"
                            />
                            <button type="submit" className="login-button" disabled={loading}>
                                {loading ? <span className="loading-spinner"></span> : '로그인'}
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        // 메인 앱 컴포넌트
        const NeoFitPayCalc = ({ user }) => {
            const [salesData, setSalesData] = useState({});
            const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth());
            const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());
            const [approvalPasswords, setApprovalPasswords] = useState({});
            const [editPasswords, setEditPasswords] = useState({});
            const [employeeType, setEmployeeType] = useState('full');
            const [customerName, setCustomerName] = useState({});
            const [selectedProducts, setSelectedProducts] = useState({});
            const [customPrices, setCustomPrices] = useState({});
            const [expandedDays, setExpandedDays] = useState({});
            const [showAddSaleModal, setShowAddSaleModal] = useState(false);
            const [selectedModalDay, setSelectedModalDay] = useState(null);
            const [viewMode, setViewMode] = useState('daily');
            const dailyViewRef = React.useRef(null);
            const [searchQuery, setSearchQuery] = useState('');
            const [showSearchResultModal, setShowSearchResultModal] = useState(false);
            const [searchResults, setSearchResults] = useState([]);
            const [loading, setLoading] = useState(true);
            const [syncing, setSyncing] = useState(false);
            const [unsubscribe, setUnsubscribe] = useState(null);

            // Firebase 관련 함수들
            useEffect(() => {
                loadFirestoreData();
                
                return () => {
                    if (unsubscribe) {
                        unsubscribe();
                    }
                };
            }, [selectedMonth, selectedYear]);

            const loadFirestoreData = async () => {
                setLoading(true);
                
                try {
                    const startDate = `${selectedYear}-${String(selectedMonth + 1).padStart(2, '0')}-01`;
                    const endDate = `${selectedYear}-${String(selectedMonth + 1).padStart(2, '0')}-31`;
                    
                    const q = window.firebase.query(
                        window.firebase.collection(window.firebase.db, 'sales'),
                        window.firebase.where('date', '>=', startDate),
                        window.firebase.where('date', '<=', endDate),
                        window.firebase.orderBy('date', 'asc')
                    );

                    const unsub = window.firebase.onSnapshot(q, (snapshot) => {
                        const data = {};
                        snapshot.forEach((doc) => {
                            const docData = doc.data();
                            data[docData.date] = {
                                ...docData,
                                id: doc.id,
                                details: docData.details || []
                            };
                        });
                        setSalesData(data);
                        setLoading(false);
                    });

                    setUnsubscribe(() => unsub);
                } catch (error) {
                    console.error('데이터 로드 실패:', error);
                    setLoading(false);
                }
            };

            const saveSaleToFirestore = async (dateKey, saleData) => {
                setSyncing(true);
                try {
                    const docId = saleData.id || `${dateKey}-${Date.now()}`;
                    const docRef = window.firebase.doc(window.firebase.db, 'sales', docId);
                    
                    await window.firebase.setDoc(docRef, {
                        ...saleData,
                        date: dateKey,
                        createdAt: saleData.createdAt || window.firebase.serverTimestamp(),
                        createdBy: saleData.createdBy || user.email,
                        modifiedAt: window.firebase.serverTimestamp(),
                        modifiedBy: user.email
                    });
                } catch (error) {
                    console.error('저장 실패:', error);
                    alert('데이터 저장에 실패했습니다.');
                } finally {
                    setSyncing(false);
                }
            };

            const updateSaleInFirestore = async (docId, updateData) => {
                setSyncing(true);
                try {
                    const docRef = window.firebase.doc(window.firebase.db, 'sales', docId);
                    await window.firebase.updateDoc(docRef, {
                        ...updateData,
                        modifiedAt: window.firebase.serverTimestamp(),
                        modifiedBy: user.email
                    });
                } catch (error) {
                    console.error('업데이트 실패:', error);
                    alert('데이터 업데이트에 실패했습니다.');
                } finally {
                    setSyncing(false);
                }
            };

            const deleteSaleFromFirestore = async (docId) => {
                setSyncing(true);
                try {
                    await window.firebase.deleteDoc(
                        window.firebase.doc(window.firebase.db, 'sales', docId)
                    );
                } catch (error) {
                    console.error('삭제 실패:', error);
                    alert('데이터 삭제에 실패했습니다.');
                } finally {
                    setSyncing(false);
                }
            };

            // 환경 변수
            const CONFIG = {
                ADMIN_PASSWORD: 'admin123',
                INCENTIVE_RATES: {
                    full: {
                        60000000: 12,
                        50000000: 10,
                        45000000: 9,
                        40000000: 8,
                        35000000: 7,
                        30000000: 6,
                        25000000: 5,
                        0: 4
                    },
                    part: {
                        60000000: 6,
                        50000000: 5,
                        45000000: 4.5,
                        40000000: 4,
                        35000000: 3.5,
                        30000000: 3,
                        25000000: 2.5,
                        0: 2
                    }
                }
            };

            // 상품 목록
            const healthProducts = ['1개월', '3개월', '6개월', '12개월'];
            const pilatesProducts = ['3개월 (24회 주 2회)', '6개월 (48회 주 2회)', '3개월 (36회 주 3회)', '6개월 (72회 주 3회)'];
            const neofitProducts = ['3개월', '6개월', '12개월'];
            const lockerProducts = ['운동복', '락커'];
            const lockerPeriods = ['1개월', '2개월', '3개월', '4개월', '5개월', '6개월', '7개월', '8개월', '9개월', '10개월', '11개월', '12개월'];
            
            // 상품 가격표
            const productPrices = {
                '1개월': 110000,
                '3개월': 270000,
                '6개월': 480000,
                '12개월': 900000,
                '3개월 (24회 주 2회)': 384000,
                '6개월 (48회 주 2회)': 672000,
                '3개월 (36회 주 3회)': 576000,
                '6개월 (72회 주 3회)': 1008000,
                // 네오핏 가격
                '네오핏 3개월': 300000,
                '네오핏 6개월': 500000,
                '네오핏 12개월': 800000,
                // 운동복/락커 가격
                '운동복 1개월': 10000,
                '운동복 2개월': 20000,
                '운동복 3개월': 30000,
                '운동복 4개월': 40000,
                '운동복 5개월': 50000,
                '운동복 6개월': 60000,
                '운동복 7개월': 70000,
                '운동복 8개월': 80000,
                '운동복 9개월': 90000,
                '운동복 10개월': 100000,
                '운동복 11개월': 110000,
                '운동복 12개월': 120000,
                '락커 1개월': 10000,
                '락커 2개월': 20000,
                '락커 3개월': 30000,
                '락커 4개월': 40000,
                '락커 5개월': 50000,
                '락커 6개월': 60000,
                '락커 7개월': 70000,
                '락커 8개월': 80000,
                '락커 9개월': 90000,
                '락커 10개월': 100000,
                '락커 11개월': 110000,
                '락커 12개월': 120000
            };

            // 날짜 키 생성
            const getDateKey = (day) => {
                return `${selectedYear}-${String(selectedMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            };

            // 날짜별 입력 폼 토글
            const toggleDayExpansion = (day) => {
                setExpandedDays(prev => ({
                    ...prev,
                    [day]: !prev[day]
                }));
            };
            
            // 매출 입력 모달 열기
            const openAddSaleModal = (day) => {
                setSelectedModalDay(day);
                setShowAddSaleModal(true);
            };

            // 매출 상세 내역 추가
            const addSaleDetail = async (day) => {
                const dayCustomerName = customerName[day] || '';
                const daySelectedProduct = selectedProducts[day] || '';
                const dayCustomPrice = customPrices[day] || 0;

                if (!dayCustomerName.trim() || !daySelectedProduct || !dayCustomPrice) {
                    alert('회원명, 상품, 가격을 모두 입력해주세요.');
                    return;
                }

                const dateKey = getDateKey(day);
                const newDetail = {
                    id: Date.now() + Math.random(),
                    customerName: dayCustomerName.trim(),
                    product: daySelectedProduct,
                    price: parseInt(dayCustomPrice),
                    timestamp: new Date().toLocaleTimeString('ko-KR', { 
                        hour: '2-digit', 
                        minute: '2-digit',
                        second: '2-digit'
                    })
                };

                const currentData = salesData[dateKey] || { amount: 0, approved: false, details: [] };
                const newDetails = [...(currentData.details || []), newDetail];
                const newTotalAmount = newDetails.reduce((sum, detail) => sum + (detail.price || 0), 0);

                const updatedData = {
                    ...currentData,
                    details: newDetails,
                    amount: newTotalAmount
                };

                // Firebase에 저장
                await saveSaleToFirestore(dateKey, updatedData);

                // 입력 필드 초기화
                setCustomerName(prev => ({ ...prev, [day]: '' }));
                setSelectedProducts(prev => ({ ...prev, [day]: '' }));
                setCustomPrices(prev => ({ ...prev, [day]: '' }));
                
                alert('매출이 성공적으로 등록되었습니다!');
            };

            // 매출 상세 삭제
            const removeSaleDetail = async (day, detailId) => {
                const dateKey = getDateKey(day);
                const currentData = salesData[dateKey] || { amount: 0, approved: false, details: [] };
                const newDetails = currentData.details.filter(detail => detail.id !== detailId);
                const newTotalAmount = newDetails.reduce((sum, detail) => sum + (detail.price || 0), 0);

                const updatedData = {
                    ...currentData,
                    details: newDetails,
                    amount: newTotalAmount
                };

                if (currentData.id) {
                    await updateSaleInFirestore(currentData.id, updatedData);
                }
            };

            // 관리자 승인 처리
            const handleAdminApproval = async (day) => {
                const dateKey = getDateKey(day);
                const password = approvalPasswords[dateKey] || '';
                
                if (password === CONFIG.ADMIN_PASSWORD) {
                    const currentData = salesData[dateKey];
                    if (currentData && currentData.id) {
                        await updateSaleInFirestore(currentData.id, {
                            ...currentData,
                            approved: true
                        });
                    }
                    setApprovalPasswords(prev => ({
                        ...prev,
                        [dateKey]: ''
                    }));
                } else {
                    alert('비밀번호가 올바르지 않습니다.');
                }
            };

            // 수정 모드 처리
            const handleEditMode = async (day) => {
                const dateKey = getDateKey(day);
                const password = editPasswords[dateKey] || '';
                
                if (password === CONFIG.ADMIN_PASSWORD) {
                    const currentData = salesData[dateKey];
                    if (currentData && currentData.id) {
                        await updateSaleInFirestore(currentData.id, {
                            ...currentData,
                            approved: false
                        });
                    }
                    setEditPasswords(prev => ({
                        ...prev,
                        [dateKey]: ''
                    }));
                } else {
                    alert('비밀번호가 올바르지 않습니다.');
                }
            };

            // 월의 일수 구하기
            const getDaysInMonth = () => {
                return new Date(selectedYear, selectedMonth + 1, 0).getDate();
            };

            // 주간 매출 계산
            const calculateWeeklySales = () => {
                const weeks = [];
                const daysInMonth = getDaysInMonth();
                let currentWeek = [];
                let weekTotal = 0;

                for (let day = 1; day <= daysInMonth; day++) {
                    const dateKey = getDateKey(day);
                    const dayData = salesData[dateKey] || { amount: 0, approved: false };
                    if (dayData.approved) {
                        weekTotal += dayData.amount;
                    }
                    currentWeek.push(day);

                    if (currentWeek.length === 7 || day === daysInMonth) {
                        weeks.push({
                            days: [...currentWeek],
                            total: weekTotal
                        });
                        currentWeek = [];
                        weekTotal = 0;
                    }
                }

                return weeks;
            };

            // 월간 매출 계산
            const calculateMonthlySales = () => {
                let total = 0;
                const daysInMonth = getDaysInMonth();

                for (let day = 1; day <= daysInMonth; day++) {
                    const dateKey = getDateKey(day);
                    const dayData = salesData[dateKey] || { amount: 0, approved: false };
                    if (dayData.approved) {
                        total += dayData.amount;
                    }
                }

                return total;
            };

            // 인센티브율 계산
            const getIncentiveRate = (totalSales, type = null) => {
                const employeeTypeToUse = type || employeeType;
                const rates = CONFIG.INCENTIVE_RATES;

                const thresholds = Object.keys(rates[employeeTypeToUse])
                    .map(Number)
                    .sort((a, b) => b - a);

                for (const threshold of thresholds) {
                    if (totalSales >= threshold) {
                        return rates[employeeTypeToUse][threshold];
                    }
                }
                
                return rates[employeeTypeToUse][0];
            };

            // 숫자 포맷팅 함수들
            const formatNumberWithCommas = (num) => {
                if (!num) return '';
                return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            };

            const removeCommas = (str) => {
                return str.replace(/,/g, '');
            };

            // 아이콘 컴포넌트
            const Icon = ({ icon, size = 20, style = {} }) => {
                const icons = {
                    user: <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>,
                    Search: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>,
                    Calendar: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
                    TrendingUp: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>,
                    DollarSign: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>,
                    ChevronDown: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="6 9 12 15 18 9"/></svg>,
                    Plus: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
                    X: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
                    Edit: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>,
                    Check: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><polyline points="20 6 9 17 4 12"/></svg>,
                    Package: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><line x1="16.5" y1="9.4" x2="7.5" y2="4.21"/><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>,
                    CreditCard: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>,
                    Eye: <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                };

                return <span style={style}>{icons[icon] || null}</span>;
            };

            // 검색 기능
            const handleSearch = () => {
                if (!searchQuery.trim()) {
                    alert('검색어를 입력해주세요.');
                    return;
                }

                const results = [];
                Object.entries(salesData).forEach(([date, data]) => {
                    if (data.details) {
                        data.details.forEach(detail => {
                            if (detail.customerName.toLowerCase().includes(searchQuery.toLowerCase())) {
                                results.push({
                                    date,
                                    ...detail
                                });
                            }
                        });
                    }
                });

                setSearchResults(results);
                setShowSearchResultModal(true);
            };

            // 로그아웃
            const handleLogout = async () => {
                try {
                    await window.firebase.signOut(window.firebase.auth);
                } catch (error) {
                    console.error('로그아웃 실패:', error);
                }
            };

            const monthlyTotal = calculateMonthlySales();
            const incentiveRate = getIncentiveRate(monthlyTotal);
            const incentiveAmount = monthlyTotal * (incentiveRate / 100);
            const weeklySales = calculateWeeklySales();

            // 오늘 날짜로 스크롤
            const scrollToToday = () => {
                const today = new Date();
                if (today.getMonth() === selectedMonth && today.getFullYear() === selectedYear) {
                    const todayDay = today.getDate();
                    const todayElement = document.getElementById(`day-${todayDay}`);
                    if (todayElement) {
                        todayElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            };

            // 가격 색상 계산 함수
            const getPriceColor = (price) => {
                if (price >= 900000) return '#FF00FF'; // 보라색
                if (price >= 700000) return '#FF0080'; // 핑크
                if (price >= 500000) return '#FF0000'; // 빨강
                if (price >= 400000) return '#FF8C00'; // 주황
                if (price >= 300000) return '#FFD700'; // 금색
                if (price >= 200000) return '#00FF00'; // 초록
                if (price >= 100000) return '#00CED1'; // 청록
                if (price >= 50000) return '#1E90FF'; // 파랑
                return '#808080'; // 회색
            };

            // 매출 입력 모달
            const AddSaleModal = () => {
                const [modalData, setModalData] = useState({
                    customerName: '',
                    healthProduct: '',
                    pilatesProduct: '',
                    neofitProduct: '',
                    lockerProduct: '',
                    lockerType: '',
                    lockerPeriod: '',
                    price: '',
                    discount: ''
                });
                
                // 상품 선택 시 가격 자동 계산
                React.useEffect(() => {
                    let totalPrice = 0;
                    if (modalData.healthProduct) totalPrice += productPrices[modalData.healthProduct] || 0;
                    if (modalData.pilatesProduct) totalPrice += productPrices[modalData.pilatesProduct] || 0;
                    if (modalData.neofitProduct) {
                        const neofitKey = `네오핏 ${modalData.neofitProduct}`;
                        totalPrice += productPrices[neofitKey] || 0;
                    }
                    if (modalData.lockerType && modalData.lockerPeriod) {
                        const lockerKey = `${modalData.lockerType} ${modalData.lockerPeriod}`;
                        totalPrice += productPrices[lockerKey] || 0;
                    }
                    
                    // 할인 금액 차감
                    const discount = parseInt(removeCommas(modalData.discount)) || 0;
                    const finalPrice = Math.max(0, totalPrice - discount);
                    
                    setModalData(prev => ({ ...prev, price: formatNumberWithCommas(finalPrice) }));
                }, [modalData.healthProduct, modalData.pilatesProduct, modalData.neofitProduct, modalData.lockerType, modalData.lockerPeriod, modalData.discount]);
                
                const handleSubmit = async (e) => {
                    e.preventDefault();
                    const selectedProducts = [];
                    if (modalData.healthProduct) selectedProducts.push('헬스: ' + modalData.healthProduct);
                    if (modalData.pilatesProduct) selectedProducts.push('필라테스: ' + modalData.pilatesProduct);
                    if (modalData.neofitProduct) selectedProducts.push('네오핏: ' + modalData.neofitProduct);
                    if (modalData.lockerType && modalData.lockerPeriod) {
                        selectedProducts.push(`${modalData.lockerType}: ${modalData.lockerPeriod}`);
                    }
                    
                    if (!modalData.customerName || selectedProducts.length === 0 || !modalData.price) {
                        alert('회원명, 상품(최소 1개), 가격을 모두 입력해주세요.');
                        return;
                    }
                    
                    const dateKey = getDateKey(selectedModalDay);
                    const newDetail = {
                        id: Date.now() + Math.random(),
                        customerName: modalData.customerName.trim(),
                        product: selectedProducts.join(', '),
                        price: parseInt(removeCommas(modalData.price)),
                        timestamp: new Date().toLocaleTimeString('ko-KR', { 
                            hour: '2-digit', 
                            minute: '2-digit',
                            second: '2-digit'
                        })
                    };
                    
                    const currentData = salesData[dateKey] || { amount: 0, approved: false, details: [] };
                    const newDetails = [...(currentData.details || []), newDetail];
                    const newTotalAmount = newDetails.reduce((sum, detail) => sum + (detail.price || 0), 0);
                    
                    const updatedData = {
                        ...currentData,
                        details: newDetails,
                        amount: newTotalAmount
                    };

                    // Firebase에 저장
                    await saveSaleToFirestore(dateKey, updatedData);
                    
                    setShowAddSaleModal(false);
                    setModalData({ customerName: '', healthProduct: '', pilatesProduct: '', neofitProduct: '', lockerProduct: '', lockerType: '', lockerPeriod: '', price: '', discount: '' });
                    
                    // 해당 날짜로 스크롤
                    setTimeout(() => {
                        const dayElement = document.getElementById(`day-${selectedModalDay}`);
                        if (dayElement && dailyViewRef.current) {
                            dayElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }, 100);
                };
                
                return (
                    <div className="modal-backdrop" onClick={() => setShowAddSaleModal(false)}>
                        <div className="modal-content slide-in" style={{ width: '500px', maxWidth: '90%' }} onClick={(e) => e.stopPropagation()}>
                            <h3 className="text-2xl font-bold mb-6 text-center" style={{ color: '#00FF88' }}>
                                {selectedMonth + 1}월 {selectedModalDay}일 매출 입력
                            </h3>
                            
                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div>
                                    <label className="block text-sm font-semibold mb-2 text-gray-300">회원명</label>
                                    <input
                                        type="text"
                                        value={modalData.customerName}
                                        onChange={(e) => setModalData({...modalData, customerName: e.target.value})}
                                        className="glass-effect rounded-lg px-4 py-3 w-full focus:border-green-400 focus:outline-none"
                                        placeholder="회원명을 입력하세요"
                                        autoFocus
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-semibold mb-2 text-gray-300">헬스 이용권</label>
                                    <select
                                        value={modalData.healthProduct}
                                        onChange={(e) => setModalData({...modalData, healthProduct: e.target.value})}
                                        className="glass-effect rounded-lg px-4 py-3 w-full focus:border-green-400 focus:outline-none"
                                    >
                                        <option value="">헬스 이용권 선택</option>
                                        {healthProducts.map(product => (
                                            <option key={product} value={product}>
                                                {product} - {productPrices[product].toLocaleString()}원
                                            </option>
                                        ))}
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-semibold mb-2 text-gray-300">필라테스 이용권</label>
                                    <select
                                        value={modalData.pilatesProduct}
                                        onChange={(e) => setModalData({...modalData, pilatesProduct: e.target.value})}
                                        className="glass-effect rounded-lg px-4 py-3 w-full focus:border-green-400 focus:outline-none"
                                    >
                                        <option value="">필라테스 이용권 선택</option>
                                        {pilatesProducts.map(product => (
                                            <option key={product} value={product}>
                                                {product} - {productPrices[product].toLocaleString()}원
                                            </option>
                                        ))}
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-semibold mb-2 text-gray-300">네오핏 이용권</label>
                                    <select
                                        value={modalData.neofitProduct}
                                        onChange={(e) => setModalData({...modalData, neofitProduct: e.target.value})}
                                        className="glass-effect rounded-lg px-4 py-3 w-full focus:border-green-400 focus:outline-none"
                                    >
                                        <option value="">네오핏 이용권 선택</option>
                                        {neofitProducts.map(product => {
                                            const priceKey = `네오핏 ${product}`;
                                            return (
                                                <option key={product} value={product}>
                                                    {product} - {productPrices[priceKey].toLocaleString()}원
                                                </option>
                                            );
                                        })}
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-semibold mb-2 text-gray-300">운동복/락커 선택</label>
                                    <select
                                        value={modalData.lockerType}
                                        onChange={(e) => setModalData({...modalData, lockerType: e.target.value, lockerPeriod: ''})}
                                        className="glass-effect rounded-lg px-4 py-3 w-full focus:border-green-400 focus:outline-none"
                                    >
                                        <option value="">운동복/락커 선택</option>
                                        {lockerProducts.map(product => (
                                            <option key={product} value={product}>{product}</option>
                                        ))}
                                    </select>
                                </div>
                                
                                {modalData.lockerType && (
                                    <div>
                                        <label className="block text-sm font-semibold mb-2 text-gray-300">{modalData.lockerType} 이용 기간</label>
                                        <select
                                            value={modalData.lockerPeriod}
                                            onChange={(e) => setModalData({...modalData, lockerPeriod: e.target.value})}
                                            className="glass-effect rounded-lg px-4 py-3 w-full focus:border-green-400 focus:outline-none"
                                        >
                                            <option value="">기간 선택</option>
                                            {lockerPeriods.map(period => {
                                                const priceKey = `${modalData.lockerType} ${period}`;
                                                const price = productPrices[priceKey] || 0;
                                                return (
                                                    <option key={period} value={period}>
                                                        {period} - {price.toLocaleString()}원
                                                    </option>
                                                );
                                            })}
                                        </select>
                                    </div>
                                )}
                                
                                <div>
                                    <label className="block text-sm font-semibold mb-2 text-gray-300">할인 금액</label>
                                    <input
                                        type="text"
                                        value={modalData.discount}
                                        onChange={(e) => {
                                            const value = e.target.value.replace(/[^0-9]/g, '');
                                            setModalData({...modalData, discount: formatNumberWithCommas(value)});
                                        }}
                                        className="glass-effect rounded-lg px-4 py-3 w-full focus:border-green-400 focus:outline-none"
                                        placeholder="할인 금액을 입력하세요"
                                        style={{ fontSize: '16px' }}
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-semibold mb-2 text-gray-300">최종 금액</label>
                                    <input
                                        type="text"
                                        value={modalData.price}
                                        readOnly
                                        className="glass-effect rounded-lg px-4 py-3 w-full bg-gray-800 cursor-not-allowed"
                                        style={{ color: '#00FF88', fontWeight: 'bold', fontSize: '18px' }}
                                    />
                                </div>
                                
                                <div className="flex gap-3 pt-4">
                                    <button
                                        type="button"
                                        onClick={() => setShowAddSaleModal(false)}
                                        className="flex-1 glass-effect hover:border-gray-400 rounded-lg py-3 font-semibold transition-all text-gray-300 hover:text-white"
                                    >
                                        취소
                                    </button>
                                    <button
                                        type="submit"
                                        className="flex-1 glass-effect border-green-500 hover:border-green-400 rounded-lg py-3 font-semibold transition-all hover:shadow-lg text-white"
                                    >
                                        매출 등록
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                );
            };

            // 검색 결과 모달
            const SearchResultModal = () => {
                const groupedResults = {};
                searchResults.forEach(result => {
                    const customerName = result.customerName;
                    if (!groupedResults[customerName]) {
                        groupedResults[customerName] = [];
                    }
                    groupedResults[customerName].push(result);
                });

                return (
                    <div className="modal-backdrop" onClick={() => setShowSearchResultModal(false)}>
                        <div className="modal-content slide-in" style={{ width: '600px', maxWidth: '90%', maxHeight: '80vh', overflowY: 'auto' }} onClick={(e) => e.stopPropagation()}>
                            <h3 className="text-2xl font-bold mb-6 text-center" style={{ color: '#00FF88' }}>
                                '{searchQuery}' 검색 결과
                            </h3>
                            
                            {Object.keys(groupedResults).length === 0 ? (
                                <p className="text-center text-gray-400 py-8">검색 결과가 없습니다.</p>
                            ) : (
                                <div className="space-y-6">
                                    {Object.entries(groupedResults).map(([customerName, results]) => (
                                        <div key={customerName} className="glass-effect rounded-xl p-4">
                                            <h4 className="text-lg font-bold mb-3" style={{ color: '#00C6FF' }}>{customerName}</h4>
                                            <div className="space-y-2">
                                                {results.map((result, index) => (
                                                    <div key={index} className="flex justify-between items-center py-2 border-b border-gray-700">
                                                        <div>
                                                            <p className="text-sm text-gray-400">{result.date}</p>
                                                            <p className="text-xs text-gray-500">{result.product}</p>
                                                        </div>
                                                        <p className="font-semibold" style={{ color: getPriceColor(result.price) }}>
                                                            {result.price.toLocaleString()}원
                                                        </p>
                                                    </div>
                                                ))}
                                                <div className="pt-2 mt-2 border-t border-gray-600">
                                                    <div className="flex justify-between items-center">
                                                        <span className="font-semibold text-gray-300">총 구매금액</span>
                                                        <span className="text-xl font-bold" style={{ color: '#00FF88' }}>
                                                            {results.reduce((sum, r) => sum + r.price, 0).toLocaleString()}원
                                                        </span>
                                                    </div>
                                                    <div className="flex justify-between items-center mt-1">
                                                        <span className="text-sm text-gray-400">총 구매건수</span>
                                                        <span className="text-sm text-gray-400">{results.length}건</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                            
                            <button
                                onClick={() => setShowSearchResultModal(false)}
                                className="w-full mt-6 glass-effect border-gray-500 hover:border-gray-400 rounded-lg py-3 font-semibold transition-all text-gray-300 hover:text-white"
                            >
                                닫기
                            </button>
                        </div>
                    </div>
                );
            };

            if (loading) {
                return (
                    <div className="main-container" style={{
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        minHeight: '100vh'
                    }}>
                        <div className="loading-spinner" style={{width: '50px', height: '50px'}}></div>
                    </div>
                );
            }

            return (
                <div className="main-container">
                    <div className="top-bar">
                        <div className="sync-status">
                            <div className="sync-icon"></div>
                            <span>{syncing ? '동기화 중...' : '실시간 동기화'}</span>
                        </div>
                        <div className="user-info">
                            <span>{user.email}</span>
                            <button onClick={handleLogout} className="logout-button">
                                로그아웃
                            </button>
                        </div>
                    </div>

                    <div className="content-wrapper">
                        <h1 className="text-center text-5xl font-black mb-8" style={{
                            background: 'linear-gradient(135deg, #00FF88 0%, #00CC6A 100%)',
                            WebkitBackgroundClip: 'text',
                            WebkitTextFillColor: 'transparent',
                            textShadow: '0 0 30px rgba(0, 255, 136, 0.3)'
                        }}>
                            NeoFit PayCalc
                        </h1>

                        {/* 검색 바 */}
                        <div className="glass-effect rounded-2xl p-4 mb-8 flex items-center gap-4">
                            <Icon icon="Search" size={24} style={{ color: '#00FF88' }} />
                            <input
                                type="text"
                                value={searchQuery}
                                onChange={(e) => setSearchQuery(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && handleSearch()}
                                placeholder="회원명 검색..."
                                className="flex-1 bg-transparent outline-none text-lg"
                            />
                            <button
                                onClick={handleSearch}
                                className="glass-effect rounded-xl px-6 py-2 hover:border-green-400 transition-all font-semibold"
                            >
                                검색
                            </button>
                        </div>

                        {/* 컨트롤 바 */}
                        <div className="glass-effect rounded-2xl p-6 mb-8">
                            <div className="flex flex-wrap items-center justify-between gap-4">
                                <div className="flex gap-3">
                                    <button
                                        onClick={() => setEmployeeType('full')}
                                        className={`px-6 py-3 rounded-xl font-semibold transition-all ${
                                            employeeType === 'full' 
                                                ? 'bg-gradient-to-r from-green-500 to-green-600 text-white shadow-lg' 
                                                : 'glass-effect hover:border-green-400'
                                        }`}
                                    >
                                        정직원
                                    </button>
                                    <button
                                        onClick={() => setEmployeeType('part')}
                                        className={`px-6 py-3 rounded-xl font-semibold transition-all ${
                                            employeeType === 'part' 
                                                ? 'bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg' 
                                                : 'glass-effect hover:border-blue-400'
                                        }`}
                                    >
                                        파트타임
                                    </button>
                                </div>
                                
                                <div className="flex gap-3">
                                    <select
                                        value={selectedMonth}
                                        onChange={(e) => setSelectedMonth(parseInt(e.target.value))}
                                        className="glass-effect rounded-xl px-4 py-3 focus:border-green-400 focus:outline-none"
                                    >
                                        {Array.from({ length: 12 }, (_, i) => (
                                            <option key={i} value={i}>
                                                {new Date(2024, i).toLocaleDateString('ko-KR', { month: 'long' })}
                                            </option>
                                        ))}
                                    </select>
                                    
                                    <select
                                        value={selectedYear}
                                        onChange={(e) => setSelectedYear(parseInt(e.target.value))}
                                        className="glass-effect rounded-xl px-4 py-3 focus:border-green-400 focus:outline-none"
                                    >
                                        {[2023, 2024, 2025, 2026].map(year => (
                                            <option key={year} value={year}>{year}년</option>
                                        ))}
                                    </select>
                                </div>
                            </div>
                        </div>

                        {/* 매출 현황 */}
                        <div className="gradient-border mb-8">
                            <div>
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-2xl font-bold flex items-center gap-3">
                                        <div className="p-2 bg-green-500/20 rounded-lg">
                                            <Icon icon="Calendar" size={28} style={{ color: '#00FF88' }} />
                                        </div>
                                        매출 현황
                                    </h2>
                                    
                                    <div className="flex gap-2">
                                        <button
                                            onClick={() => setViewMode('daily')}
                                            className={`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${
                                                viewMode === 'daily' ? 'bg-green-500 text-white' : 'glass-effect hover:border-green-400'
                                            }`}
                                        >
                                            일별
                                        </button>
                                        <button
                                            onClick={() => setViewMode('weekly')}
                                            className={`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${
                                                viewMode === 'weekly' ? 'bg-blue-500 text-white' : 'glass-effect hover:border-blue-400'
                                            }`}
                                        >
                                            주별
                                        </button>
                                        <button
                                            onClick={() => setViewMode('monthly')}
                                            className={`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${
                                                viewMode === 'monthly' ? 'bg-purple-500 text-white' : 'glass-effect hover:border-purple-400'
                                            }`}
                                        >
                                            월별
                                        </button>
                                    </div>
                                </div>

                                {/* 일별 뷰 */}
                                {viewMode === 'daily' && (
                                    <div>
                                        <div className="flex justify-between items-center mb-4">
                                            <div className="text-sm text-gray-400">
                                                <span className="inline-block w-3 h-3 rounded-full mr-2" style={{ backgroundColor: '#808080' }}></span>50,000원 미만
                                                <span className="inline-block w-3 h-3 rounded-full ml-4 mr-2" style={{ backgroundColor: '#1E90FF' }}></span>50,000원 이상
                                                <span className="inline-block w-3 h-3 rounded-full ml-4 mr-2" style={{ backgroundColor: '#00CED1' }}></span>100,000원 이상
                                                <span className="inline-block w-3 h-3 rounded-full ml-4 mr-2" style={{ backgroundColor: '#00FF00' }}></span>200,000원 이상
                                                <span className="inline-block w-3 h-3 rounded-full ml-4 mr-2" style={{ backgroundColor: '#FFD700' }}></span>300,000원 이상
                                                <span className="inline-block w-3 h-3 rounded-full ml-4 mr-2" style={{ backgroundColor: '#FF8C00' }}></span>400,000원 이상
                                                <span className="inline-block w-3 h-3 rounded-full ml-4 mr-2" style={{ backgroundColor: '#FF0000' }}></span>500,000원 이상
                                                <span className="inline-block w-3 h-3 rounded-full ml-4 mr-2" style={{ backgroundColor: '#FF0080' }}></span>700,000원 이상
                                                <span className="inline-block w-3 h-3 rounded-full ml-4 mr-2" style={{ backgroundColor: '#FF00FF' }}></span>900,000원 이상
                                            </div>
                                            <button
                                                onClick={scrollToToday}
                                                className="glass-effect rounded-xl px-4 py-2 hover:border-green-400 transition-all text-sm font-semibold flex items-center gap-2"
                                            >
                                                <Icon icon="Calendar" size={16} />
                                                오늘로 이동
                                            </button>
                                        </div>

                                        <div ref={dailyViewRef} className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" style={{ maxHeight: '600px', overflowY: 'auto' }}>
                                            {Array.from({ length: getDaysInMonth() }, (_, i) => i + 1).map(day => {
                                                const dateKey = getDateKey(day);
                                                const dayData = salesData[dateKey] || { amount: 0, approved: false, details: [] };
                                                const date = new Date(selectedYear, selectedMonth, day);
                                                const dayName = date.toLocaleDateString('ko-KR', { weekday: 'short' });
                                                const isWeekend = date.getDay() === 0 || date.getDay() === 6;
                                                const isToday = date.toDateString() === new Date().toDateString();
                                                
                                                return (
                                                    <div 
                                                        key={day} 
                                                        id={`day-${day}`}
                                                        className={`glass-effect rounded-2xl p-5 hover:scale-[1.02] transition-all ${
                                                            isToday ? 'ring-2 ring-green-500' : ''
                                                        }`}
                                                    >
                                                        <div className="flex justify-between items-center mb-4">
                                                            <div>
                                                                <h3 className={`text-xl font-bold ${isWeekend ? 'text-red-400' : 'text-white'}`}>
                                                                    {selectedMonth + 1}월 {day}일
                                                                </h3>
                                                                <p className="text-sm text-gray-400">{dayName}</p>
                                                            </div>
                                                            {isToday && (
                                                                <span className="px-3 py-1 bg-green-500/20 rounded-full text-xs text-green-400 font-semibold">
                                                                    오늘
                                                                </span>
                                                            )}
                                                        </div>
                                                        
                                                        <div className="mb-4">
                                                            <p className="text-3xl font-black" style={{ color: getPriceColor(dayData.amount) }}>
                                                                {dayData.amount.toLocaleString()}원
                                                            </p>
                                                            <p className="text-sm text-gray-400 mt-1">
                                                                {dayData.details?.length || 0}건의 매출
                                                            </p>
                                                        </div>

                                                        {/* 매출 내역 */}
                                                        {dayData.details && dayData.details.length > 0 && (
                                                            <div className="space-y-2 mb-4">
                                                                {dayData.details.map(detail => (
                                                                    <div key={detail.id} className="glass-effect rounded-lg p-3 text-sm">
                                                                        <div className="flex justify-between items-start">
                                                                            <div className="flex-1">
                                                                                <p className="font-semibold">{detail.customerName}</p>
                                                                                <p className="text-xs text-gray-400">{detail.product}</p>
                                                                                <p className="font-bold mt-1" style={{ color: getPriceColor(detail.price) }}>
                                                                                    {detail.price.toLocaleString()}원
                                                                                </p>
                                                                            </div>
                                                                            {!dayData.approved && (
                                                                                <button
                                                                                    onClick={() => removeSaleDetail(day, detail.id)}
                                                                                    className="text-red-400 hover:text-red-300 p-1"
                                                                                >
                                                                                    <Icon icon="X" size={16} />
                                                                                </button>
                                                                            )}
                                                                        </div>
                                                                        <p className="text-xs text-gray-500 mt-1">{detail.timestamp}</p>
                                                                    </div>
                                                                ))}
                                                            </div>
                                                        )}

                                                        {/* 매출 입력 버튼 */}
                                                        {!dayData.approved && (
                                                            <button
                                                                onClick={() => openAddSaleModal(day)}
                                                                className="w-full glass-effect border-green-500 hover:border-green-400 rounded-xl py-3 font-semibold transition-all hover:shadow-lg text-white flex items-center justify-center gap-2 mb-4"
                                                            >
                                                                <Icon icon="Plus" size={18} />
                                                                빠른 매출 입력
                                                            </button>
                                                        )}

                                                        {/* 승인/수정 */}
                                                        {!dayData.approved ? (
                                                            <div className="flex gap-2">
                                                                <input
                                                                    type="password"
                                                                    value={approvalPasswords[dateKey] || ''}
                                                                    onChange={(e) => setApprovalPasswords(prev => ({
                                                                        ...prev,
                                                                        [dateKey]: e.target.value
                                                                    }))}
                                                                    placeholder="PW"
                                                                    className="w-8 px-1 py-1.5 text-sm rounded border border-gray-600 bg-gray-700 text-white focus:border-blue-500"
                                                                    style={{ fontSize: '16px' }}
                                                                    onKeyPress={(e) => {
                                                                        if (e.key === 'Enter') {
                                                                            handleAdminApproval(day);
                                                                        }
                                                                    }}
                                                                />
                                                                <button
                                                                    onClick={() => handleAdminApproval(day)}
                                                                    className="flex-1 glass-effect border-blue-500 hover:border-blue-400 rounded-xl py-3 text-base font-semibold transition-all hover:shadow-lg text-white"
                                                                >
                                                                    승인
                                                                </button>
                                                            </div>
                                                        ) : (
                                                            <div className="space-y-3">
                                                                <button
                                                                    className="w-full glass-effect border-green-500 rounded-xl py-3 text-base font-semibold cursor-default flex items-center justify-center gap-2 shadow-lg text-white opacity-70"
                                                                    disabled
                                                                >
                                                                    <Icon icon="Check" size={18} />
                                                                    정산완료
                                                                </button>
                                                                <div className="flex gap-2">
                                                                    <input
                                                                        type="password"
                                                                        value={editPasswords[dateKey] || ''}
                                                                        onChange={(e) => setEditPasswords(prev => ({
                                                                            ...prev,
                                                                            [dateKey]: e.target.value
                                                                        }))}
                                                                        placeholder="PW"
                                                                        className="w-8 px-1 py-1.5 text-sm rounded border border-gray-600 bg-gray-700 text-white focus:border-orange-400"
                                                                        style={{ fontSize: '16px' }}
                                                                        onKeyPress={(e) => {
                                                                            if (e.key === 'Enter') {
                                                                                handleEditMode(day);
                                                                            }
                                                                        }}
                                                                    />
                                                                    <button
                                                                        onClick={() => handleEditMode(day)}
                                                                        className="flex-1 glass-effect border-orange-500 hover:border-orange-400 rounded-xl py-3 text-base font-semibold transition-all hover:shadow-lg text-white flex items-center justify-center gap-2"
                                                                    >
                                                                        <Icon icon="Edit" size={16} />
                                                                        수정
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        )}
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                )}

                                {/* 주별 뷰 */}
                                {viewMode === 'weekly' && (
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        {weeklySales.map((week, index) => (
                                            <div key={index} className="glass-effect rounded-2xl p-6 hover:scale-[1.02] transition-all">
                                                <h3 className="text-xl font-bold mb-4 flex items-center justify-between">
                                                    <span>{week.days[0]}일 - {week.days[week.days.length - 1]}일</span>
                                                    <span className="text-2xl" style={{ color: '#00C6FF' }}>
                                                        {week.total.toLocaleString()}원
                                                    </span>
                                                </h3>
                                                <div className="space-y-2">
                                                    {week.days.map(day => {
                                                        const dateKey = getDateKey(day);
                                                        const dayData = salesData[dateKey] || { amount: 0, approved: false };
                                                        return (
                                                            <div key={day} className="flex justify-between items-center py-2 border-b border-gray-700">
                                                                <span className="text-gray-400">{selectedMonth + 1}월 {day}일</span>
                                                                <span className={dayData.approved ? 'text-green-400' : 'text-gray-500'}>
                                                                    {dayData.amount.toLocaleString()}원
                                                                </span>
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}

                                {/* 월별 뷰 */}
                                {viewMode === 'monthly' && (
                                    <div className="glass-effect rounded-2xl p-8">
                                        <div className="text-center">
                                            <h3 className="text-3xl font-bold mb-2">{selectedYear}년 {selectedMonth + 1}월</h3>
                                            <p className="text-5xl font-black mb-4" style={{ color: '#00FF88' }}>
                                                {monthlyTotal.toLocaleString()}원
                                            </p>
                                            <div className="grid grid-cols-2 gap-4 mt-8">
                                                <div className="bg-gray-800/50 rounded-xl p-4">
                                                    <p className="text-gray-400 mb-2">승인된 매출</p>
                                                    <p className="text-2xl font-bold text-green-400">
                                                        {Object.entries(salesData).filter(([_, data]) => data.approved).length}건
                                                    </p>
                                                </div>
                                                <div className="bg-gray-800/50 rounded-xl p-4">
                                                    <p className="text-gray-400 mb-2">평균 일매출</p>
                                                    <p className="text-2xl font-bold">
                                                        {Math.floor(monthlyTotal / getDaysInMonth()).toLocaleString()}원
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* 주간 매출 합계 */}
                        <div className="gradient-border mb-8">
                            <div>
                                <h2 className="text-2xl font-bold mb-6 flex items-center gap-3">
                                    <div className="p-2 bg-blue-500/20 rounded-lg">
                                        <Icon icon="TrendingUp" size={28} style={{ color: '#00C6FF' }} />
                                    </div>
                                    주간 매출 합계
                                </h2>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    {weeklySales.map((week, index) => (
                                        <div key={index} className="glass-effect rounded-2xl p-5 hover:scale-105 transition-all duration-300">
                                            <div className="flex flex-col">
                                                <span className="text-sm text-gray-400 mb-2">
                                                    {week.days[0]}일 - {week.days[week.days.length - 1]}일
                                                </span>
                                                <span className="text-2xl font-black" style={{ color: '#00C6FF' }}>
                                                    {(week.total || 0).toLocaleString()}원
                                                </span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* 월간 총계 및 인센티브 */}
                        <div className="gradient-border glow-green">
                            <div className="bg-gradient-to-br from-gray-800/50 to-gray-900/50">
                                <h2 className="text-3xl font-black mb-8 text-center text-white">
                                    월간 급여 계산
                                </h2>
                                
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6 text-center mb-6 sm:mb-8">
                                    <div className="glass-effect rounded-2xl p-4 sm:p-6 hover:scale-105 transition-all duration-300">
                                        <p className="text-gray-400 text-xs sm:text-sm mb-2 sm:mb-3 font-semibold">월간 총매출</p>
                                        <p className="text-2xl sm:text-3xl font-black" style={{ color: '#FF8C00' }}>{(monthlyTotal || 0).toLocaleString()}원</p>
                                    </div>
                                    
                                    <div className="glass-effect rounded-2xl p-4 sm:p-6 hover:scale-105 transition-all duration-300">
                                        <p className="text-gray-400 text-xs sm:text-sm mb-2 sm:mb-3 font-semibold">인센티브율 ({employeeType === 'full' ? '정직원' : '파트타임'})</p>
                                        <p className="text-2xl sm:text-3xl font-black" style={{ color: '#00C6FF' }}>{incentiveRate || 0}%</p>
                                    </div>
                                    
                                    <div className="glass-effect rounded-2xl p-4 sm:p-6 hover:scale-105 transition-all duration-300">
                                        <p className="text-gray-400 text-xs sm:text-sm mb-2 sm:mb-3 font-semibold">인센티브 금액</p>
                                        <p className="text-2xl sm:text-3xl font-black" style={{ color: '#00FF88' }}>
                                            {Math.floor(incentiveAmount || 0).toLocaleString()}원
                                        </p>
                                    </div>
                                </div>

                                {/* 인센티브 기준표 */}
                                <div className="glass-effect rounded-2xl p-6">
                                    <p className="text-lg font-bold text-center mb-4 text-gray-300">
                                        인센티브 기준표 ({employeeType === 'full' ? '정직원' : '파트타임'})
                                    </p>
                                    <div className="grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-3 text-xs text-center">
                                        <div className="glass-effect rounded-xl p-2 sm:p-3 hover:scale-105 transition-all">
                                            <p className="text-gray-400 mb-1 text-xs">2,500만원 미만</p>
                                            <p className="font-bold text-base sm:text-lg" style={{ color: '#FF6B6B' }}>{employeeType === 'full' ? '4%' : '2%'}</p>
                                        </div>
                                        <div className="glass-effect rounded-xl p-2 sm:p-3 hover:scale-105 transition-all">
                                            <p className="text-gray-400 mb-1 text-xs">2,500만원 이상</p>
                                            <p className="font-bold text-base sm:text-lg" style={{ color: '#FF9F40' }}>{employeeType === 'full' ? '5%' : '2.5%'}</p>
                                        </div>
                                        <div className="glass-effect rounded-xl p-2 sm:p-3 hover:scale-105 transition-all">
                                            <p className="text-gray-400 mb-1 text-xs">3,000만원 이상</p>
                                            <p className="font-bold text-base sm:text-lg" style={{ color: '#FFD93D' }}>{employeeType === 'full' ? '6%' : '3%'}</p>
                                        </div>
                                        <div className="glass-effect rounded-xl p-2 sm:p-3 hover:scale-105 transition-all">
                                            <p className="text-gray-400 mb-1 text-xs">3,500만원 이상</p>
                                            <p className="font-bold text-base sm:text-lg" style={{ color: '#6BCF7F' }}>{employeeType === 'full' ? '7%' : '3.5%'}</p>
                                        </div>
                                        <div className="glass-effect rounded-xl p-2 sm:p-3 hover:scale-105 transition-all">
                                            <p className="text-gray-400 mb-1 text-xs">4,000만원 이상</p>
                                            <p className="font-bold text-base sm:text-lg" style={{ color: '#4ECDC4' }}>{employeeType === 'full' ? '8%' : '4%'}</p>
                                        </div>
                                        <div className="glass-effect rounded-xl p-2 sm:p-3 hover:scale-105 transition-all">
                                            <p className="text-gray-400 mb-1 text-xs">4,500만원 이상</p>
                                            <p className="font-bold text-base sm:text-lg" style={{ color: '#45B7D1' }}>{employeeType === 'full' ? '9%' : '4.5%'}</p>
                                        </div>
                                        <div className="glass-effect rounded-xl p-2 sm:p-3 hover:scale-105 transition-all">
                                            <p className="text-gray-400 mb-1 text-xs">5,000만원 이상</p>
                                            <p className="font-bold text-base sm:text-lg" style={{ color: '#5D5FEF' }}>{employeeType === 'full' ? '10%' : '5%'}</p>
                                        </div>
                                        <div className="glass-effect rounded-xl p-2 sm:p-3 hover:scale-105 transition-all">
                                            <p className="text-gray-400 mb-1 text-xs">6,000만원 이상</p>
                                            <p className="font-bold text-base sm:text-lg" style={{ color: '#A55FEB' }}>{employeeType === 'full' ? '12%' : '6%'}</p>
                                        </div>
                                    </div>
                                    
                                    {/* 정직원/파트타임 비교표 */}
                                    <div className="mt-6 glass-effect rounded-2xl p-6">
                                        <p className="text-lg font-bold mb-4 text-center">현재 매출 기준 인센티브 비교</p>
                                        <div className="grid grid-cols-2 gap-4 text-center">
                                            <div 
                                                className={`rounded-xl p-4 cursor-pointer transition-all duration-300 ${
                                                    employeeType === 'full' 
                                                        ? 'scale-105 shadow-lg text-white' 
                                                        : 'glass-effect hover:scale-105 hover:border-gray-400'
                                                }`}
                                                style={employeeType === 'full' ? { 
                                                    backgroundColor: '#0a4a2c', 
                                                    border: '2px solid #00FF88',
                                                    boxShadow: '0 0 20px rgba(0, 255, 136, 0.6), inset 0 0 20px rgba(0, 255, 136, 0.2)'
                                                } : {}}
                                                onClick={() => setEmployeeType('full')}
                                            >
                                                <p className={`text-sm font-semibold mb-2 ${employeeType === 'full' ? 'text-green-400' : ''}`}>정직원</p>
                                                <p className={`font-black text-2xl mb-2 ${employeeType === 'full' ? 'text-green-400' : ''}`} style={employeeType === 'full' ? { textShadow: '0 0 10px rgba(0, 255, 136, 0.8)' } : {}}>{getIncentiveRate(monthlyTotal, 'full')}%</p>
                                                <p className={`text-sm ${employeeType === 'full' ? 'text-green-400' : 'opacity-80'}`}>
                                                    {Math.floor((monthlyTotal || 0) * (getIncentiveRate(monthlyTotal, 'full') / 100)).toLocaleString()}원
                                                </p>
                                            </div>
                                            <div 
                                                className={`rounded-xl p-4 cursor-pointer transition-all duration-300 ${
                                                    employeeType === 'part' 
                                                        ? 'scale-105 shadow-lg text-white' 
                                                        : 'glass-effect hover:scale-105 hover:border-gray-400'
                                                }`}
                                                style={employeeType === 'part' ? { 
                                                    backgroundColor: '#0a4a2c', 
                                                    border: '2px solid #00FF88',
                                                    boxShadow: '0 0 20px rgba(0, 255, 136, 0.6), inset 0 0 20px rgba(0, 255, 136, 0.2)'
                                                } : {}}
                                                onClick={() => setEmployeeType('part')}
                                            >
                                                <p className={`text-sm font-semibold mb-2 ${employeeType === 'part' ? 'text-green-400' : ''}`}>파트타임</p>
                                                <p className={`font-black text-2xl mb-2 ${employeeType === 'part' ? 'text-green-400' : ''}`} style={employeeType === 'part' ? { textShadow: '0 0 10px rgba(0, 255, 136, 0.8)' } : {}}>{getIncentiveRate(monthlyTotal, 'part')}%</p>
                                                <p className={`text-sm ${employeeType === 'part' ? 'text-green-400' : 'opacity-80'}`}>
                                                    {Math.floor((monthlyTotal || 0) * (getIncentiveRate(monthlyTotal, 'part') / 100)).toLocaleString()}원
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* 모달들 */}
                        {showAddSaleModal && <AddSaleModal />}
                        {showSearchResultModal && <SearchResultModal />}
                    </div>
                </div>
            );
        };

        // 루트 앱 컴포넌트
        const App = () => {
            const [user, setUser] = useState(null);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const unsubscribe = window.firebase.onAuthStateChanged(window.firebase.auth, (user) => {
                    setUser(user);
                    setLoading(false);
                });

                return () => unsubscribe();
            }, []);

            if (loading) {
                return (
                    <div className="main-container" style={{
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        minHeight: '100vh'
                    }}>
                        <div className="loading-spinner" style={{width: '50px', height: '50px'}}></div>
                    </div>
                );
            }

            return user ? <NeoFitPayCalc user={user} /> : <LoginComponent onLogin={setUser} />;
        };

        // 앱 렌더링
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
